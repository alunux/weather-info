{"version":3,"sources":["util.js","components/GeneralIndex.js","components/RegionList.js","components/Detail.js","components/AccordionList.js","components/General.js","components/Region.js","components/Pref.js","WeatherInfoSidebar.js","WeatherInfoLayer.js","WeatherInfo.js","Map.js","App.js","index.js"],"names":["reportTime","t","pad","getMonth","getDate","getHours","getMinutes","x","slice","GeneralIndex","react_default","a","createElement","className","Header","as","List","inverted","relaxed","this","renderInfo","info","props","time","Date","datetime","now","period","title","time_str","parseInt","id","Item","onClick","Content","Description","headline","Component","RegionList","_this","keys","Object","regions","sort","map","code","region","filter","d","RegionList_AccordionListHeadline","AccordionListHeadline","state","activeIndex","handleClick","e","titleProps","index","newIndex","_this2","setState","_this3","Accordion","i","_this4","key","Title","active","Icon","name","Detail","detail","fetch","prevProps","show","then","res","json","data","console","log","comment","AccordionList","split","Divider","Detail_Detail","General","AccordionList_AccordionList","Region","regionTitle","Pref","prefTitle","WeatherInfoSidebar","Sidebar","animation","direction","vertical","visible","renderShow","renderIndex","Fragment","GeneralIndex_GeneralIndex","general","type","RegionList_RegionList","renderGeneral","renderRegion","renderPref","General_General","Region_Region","prefs","Pref_Pref","WeatherInfoLayer","onSelected","classCallCheck","weatherInfo","addSource","minzoom","maxzoom","tiles","addLayer","source","source-layer","paint","line-color","renderWeatherInfoPrefs","line-width","on","stops","pref","hokkaidoPrefCodes","_step","_iterator","_createForOfIteratorHelper","s","n","done","c","value","push","getColor","length","err","f","fill-color","property","default","count","opacity","Math","min","concat","features","properties","getCode","prefCode","select","substr","includes","setFilter","toConsumableArray","011000","012000","013000","014100","014030","015000","016000","017000","WeatherInfo","sidebar","showPref","loadWeatherInfo","timestamp","getTime","url","mode","layer","WeatherInfoSidebar_WeatherInfoSidebar","ref","el","mapboxgl","accessToken","Map","container","mapContainer","style","zoom","center","hash","attributionControl","child","onload","WeatherInfo_WeatherInfo","App","Map_Map","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.616ee263.chunk.js","sourcesContent":["\nexport function reportTime(t) {\n    var date = pad(t.getMonth() + 1) + '/' + pad(t.getDate());\n    var time = pad(t.getHours()) + ':' + pad(t.getMinutes());\n    return date + ' ' + time;\n}\n\nfunction pad(x) {\n  return ('0' + x).slice(-2);\n}\n","import React, { Component } from 'react';\nimport { Header, List } from 'semantic-ui-react';\n\nimport { reportTime } from '../util'\n\nexport default class GeneralIndex extends Component {\n\n  render() {\n    return (\n      <div className=\"info-general\">\n        <Header as='h3'>全般</Header>\n        <List inverted relaxed>\n          {this.renderInfo()}\n        </List>\n      </div>\n    );\n  }\n  \n  renderInfo() {\n    const info = this.props.info[0];\n    const time = new Date(info.datetime);\n\n    if ((Date.now() - time) <= this.props.period * 3600 * 1000){\n      const title = info.title;\n      const time_str = reportTime(time) + \" 第\" + parseInt(info.id.slice(-3)) + \"号\";\n      return (\n        <List.Item onClick={this.props.onClick} >\n          <List.Content>\n            <List.Header>{title}</List.Header>\n            <List.Description>{time_str}</List.Description>\n            <p className=\"info-list-headline\">{info.headline}</p>\n          </List.Content>\n        </List.Item>\n      );\n    } else {\n      return null;\n    }\n  }\n}\n\n","import React, { Component } from 'react';\nimport { Header, Accordion, Icon } from 'semantic-ui-react';\n\nimport { reportTime } from '../util'\n\n\nexport default class RegionList extends Component {\n  render() {\n    const keys = Object.keys(this.props.regions).sort();\n    const now = Date.now();\n    const regions = keys.map(code => {\n      const region = this.props.regions[code][0];\n      const time = new Date(region.datetime);\n\n      if ((now - time) <= this.props.period * 3600 * 1000){\n        region.code = code;\n        return region;\n      }\n    }).filter(d => d);\n\n    return (\n      <div>\n        <Header as='h3'>地方</Header>\n        <AccordionListHeadline info={regions} onClick={this.props.onClick} />\n      </div>\n    );\n  }\n}\n\n\nclass AccordionListHeadline extends Component {\n  state = { activeIndex: null }\n\n  handleClick = (e, titleProps) => {\n    const { index } = titleProps\n    const { activeIndex } = this.state\n    const newIndex = activeIndex === index ? -1 : index\n\n    this.setState({ activeIndex: newIndex })\n  }\n\n  render() {\n    return (\n      <Accordion inverted>\n        {this.props.info.map((info, i) => this.renderInfo(info, i))}\n      </Accordion>\n    );\n  }\n\n  renderInfo(info, i) {\n    const { activeIndex } = this.state;\n    const time_str = reportTime(new Date(info.datetime)) + \" 第\" + parseInt(info.id.slice(-3)) + \"号\";\n\n    return <div key={i} className=\"accordion-item\">\n      <Accordion.Title\n        active={activeIndex === i}\n        index={i}\n        onClick={this.handleClick}\n      >\n        <Icon name='dropdown' />\n        <span className=\"info-title\">{info.title}</span>\n        <p className=\"info-time\">{time_str}</p>\n      </Accordion.Title>\n      <Accordion.Content\n        active={activeIndex === i}\n        onClick={() => this.props.onClick(info.code)}\n      >\n        <p className=\"info-region-headline\">{info.headline}</p>\n      </Accordion.Content>\n    </div>;\n  }\n}\n","import React, { Component } from 'react';\n\nconst bucket = 'https://storage.googleapis.com/weather-info/d/';\n\nexport default class Detail extends Component {\n  state = { detail: null }\n\n  componentDidMount() {\n    this.fetch();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.show && !prevProps.show) this.fetch();\n  }\n\n  fetch() {\n    if (!this.props.show) return;\n    fetch(bucket + this.props.id + '.json')\n      .then(res => res.json())\n      .then(data => {\n        console.log(data);\n        this.setState({ detail: data });\n      });\n  }\n\n  render() {\n    if (!this.state.detail) return null;\n\n    return (\n      <div className=\"info-detail\">\n        {this.state.detail.comment}\n      </div>\n    );\n  }\n}\n\n\n","import React, { Component } from 'react';\nimport { Accordion, Icon, Divider } from 'semantic-ui-react';\n\nimport { reportTime } from '../util';\nimport Detail from './Detail';\n\n\nexport default class AccordionList extends Component {\n  state = { activeIndex: 0 }\n\n  handleClick = (e, titleProps) => {\n    const { index } = titleProps\n    const { activeIndex } = this.state\n    const newIndex = activeIndex === index ? -1 : index\n\n    this.setState({ activeIndex: newIndex })\n  }\n\n  render() {\n    return (\n      <Accordion inverted>\n        {this.props.info.map((info, i) => this.renderInfo(info, i))}\n      </Accordion>\n    );\n  }\n\n  renderInfo(info, i) {\n    const { activeIndex } = this.state;\n    const title = info.title.split('に関する')[0];\n    const time_str = reportTime(new Date(info.datetime)) + \" 第\" + parseInt(info.id.slice(-3)) + \"号\";\n\n    return <div key={i} className=\"accordion-item\">\n      <Accordion.Title\n        active={activeIndex === i}\n        index={i}\n        onClick={this.handleClick}\n      >\n        <Icon name='dropdown' />\n        <span className=\"info-title\">{title}</span>\n        <p className=\"info-time\">{time_str}</p>\n        <p>{info.headline}</p>\n      </Accordion.Title>\n      <Accordion.Content active={activeIndex === i} >\n        <Divider />\n        <Detail key={info.id} id={info.id} show={activeIndex === i} />\n        <Divider />\n      </Accordion.Content>\n    </div>;\n  }\n}\n","import React, { Component } from 'react';\nimport { Header } from 'semantic-ui-react';\n\nimport AccordionList from './AccordionList';\n\n\nexport default class General extends Component {\n  render() {\n    return (\n      <div className=\"info-pref\">\n        <Header as='h3'>全般気象情報</Header>\n        <AccordionList info={this.props.info} />\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Header } from 'semantic-ui-react';\n\nimport AccordionList from './AccordionList';\n\n\nexport default class Region extends Component {\n  render() {\n    const regionTitle = this.props.info[0].title.split('に関する')[1];\n\n    return (\n      <div className=\"info-pref\">\n        <Header as='h3'>{regionTitle}</Header>\n        <AccordionList info={this.props.info} key={regionTitle} />\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Header } from 'semantic-ui-react';\n\nimport AccordionList from './AccordionList';\n\n\nexport default class Pref extends Component {\n  render() {\n    const prefTitle = this.props.info[0].title.split('に関する')[1];\n\n    return (\n      <div className=\"info-pref\">\n        <Header as='h3'>{prefTitle}</Header>\n        <AccordionList info={this.props.info} key={prefTitle} />\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Sidebar, Header } from 'semantic-ui-react';\n\nimport './Sidebar.css';\n\nimport GeneralIndex from './components/GeneralIndex';\nimport RegionList from './components/RegionList';\n\nimport General from './components/General';\nimport Region from './components/Region';\nimport Pref from './components/Pref';\n\nexport default class WeatherInfoSidebar extends Component {\n  state = { show: null }; // { type, code }\n\n  render() {\n    return (\n      <Sidebar\n        animation='overlay'\n        direction='right'\n        className='sidebar-dark'\n        inverted='true'\n        vertical='true'\n        visible>\n        {this.state.show ? this.renderShow() : this.renderIndex()}\n      </Sidebar>\n    );\n  }\n\n  renderIndex() {\n    return (\n      <div>\n        <Header as='h2'>気象情報</Header>\n        {this.props.data ?\n          <>\n            <GeneralIndex\n              info={this.props.data.general}\n              period={this.props.period}\n              onClick={() => this.setState({ show: { type: 'general' } })}\n            />\n            <RegionList\n              regions={this.props.data.regions}\n              period={this.props.period}\n              onClick={(code) => this.setState({ show: { type: 'region', code } })}\n            />\n          </>\n        : null}\n      </div>\n    );\n  }\n\n  showPref(code) {\n    this.setState({ show: { type: 'pref', code } });\n  }\n\n  renderShow() {\n    const show = this.state.show;\n    console.log(show);\n    if (show.type === 'general') {\n      return this.renderGeneral();\n\n    } else if (show.type === 'region') {\n      return this.renderRegion(show.code);\n\n    } else if (show.type === 'pref') {\n      return this.renderPref(show.code);\n    }\n  }\n  \n  renderGeneral() {\n    if (this.props.data && this.props.data.general) {\n      return (\n        <General info={this.props.data.general} />\n      );\n    }\n  }\n  \n  renderRegion(code) {\n    if (this.props.data && this.props.data.regions[code]) {\n      return (\n        <Region info={this.props.data.regions[code]} />\n      );\n    }\n  }\n\n  renderPref(code) {\n    if (this.props.data && this.props.data.prefs[code]) {\n      return (\n        <Pref info={this.props.data.prefs[code]} />\n      );\n    }\n  }\n}\n\n\n","export default class WeatherInfoLayer {\n  constructor(map, data, period, onSelected) {\n    this.map = map;\n    this.weatherInfo = data;\n    this.period = period;\n    this.onSelected = onSelected;\n\n    this.map.addSource(\"pref-vt\", {\n      \"type\": \"vector\",\n      \"minzoom\": 0,\n      \"maxzoom\": 10,\n      \"tiles\": [\"https://weatherbox.github.io/warning-area-vt/pref/{z}/{x}/{y}.pbf\"]\n    });\n\n    this.map.addLayer({\n      \"id\": \"pref-line\",\n      \"type\": \"line\",\n      \"source\": \"pref-vt\",\n      \"source-layer\": \"prefallgeojson\",\n      \"paint\": {\n        \"line-color\": \"rgba(55, 55, 55, 0.4)\"\n      }\n    });\n    this.renderWeatherInfoPrefs();\n    this.map.addLayer({\n      \"id\": \"pref-line-selected\",\n      \"type\": \"line\",\n      \"source\": \"pref-vt\",\n      \"source-layer\": \"prefallgeojson\",\n      \"paint\": {\n        \"line-color\": \"rgba(70, 171, 199, 0.4)\",\n        \"line-width\": 2\n      },\n      filter: [\"==\", \"prefCode\", \"0\"]\n    });\n    \n    this.map.on('click', 'weather-info-pref', (e) => {\n      this.onClick(e);\n    });\n  }\n\n  renderWeatherInfoPrefs() {\n    const now = Date.now();\n    var stops = [];\n\n    for (let code in this.weatherInfo.prefs){\n      const pref = this.weatherInfo.prefs[code];\n      const time = new Date(pref[0].datetime);\n\n      if ((now - time) <= this.period * 3600 * 1000){\n        if (code in hokkaidoPrefCodes){\n          for (let c of hokkaidoPrefCodes[code]){\n            stops.push([c, this.getColor(pref.length)]);\n          }\n\n        }else{\n          stops.push([code, this.getColor(pref.length)]);\n        }\n      }\n    }\n\n    this.map.addLayer({\n      \"id\": \"weather-info-pref\",\n      \"type\": \"fill\",\n      \"source\": \"pref-vt\",\n      \"source-layer\": \"prefallgeojson\",\n      \"paint\": {\n        \"fill-color\": {\n          \"property\": \"prefCode\",\n          \"type\": \"categorical\",\n          \"stops\": stops,\n          \"default\": \"rgba(0, 0, 0, 0)\"\n        },\n      }\n    });\n  }\n\n  getColor(count) {\n    const opacity = Math.min(0.2 + 0.1 * count, 0.8);\n    return `rgba(0, 49, 73, ${opacity})`;\n  }\n\n  onClick(e) {\n    if (e.features) {\n      console.log(e.features[0].properties);\n      const code = this.getCode(e.features[0].properties.prefCode);\n      this.select(code);\n      this.onSelected(code);\n    }\n  }\n\n  getCode(prefCode) {\n    if (prefCode.substr(0, 2) === '01') {\n      for (let code in hokkaidoPrefCodes) {\n        if (hokkaidoPrefCodes[code].includes(prefCode)) return code;\n      }\n\n    } else {\n      return prefCode;\n    }\n  }\n\n  select(code) {\n    let filter = [code];\n    if (code in hokkaidoPrefCodes){\n      filter = hokkaidoPrefCodes[code];\n    }\n    this.map.setFilter('pref-line-selected', ['in', 'prefCode', ...filter]);\n  }\n}\n\n\nconst hokkaidoPrefCodes = {\n  \"011000\": [\"011000\"], // 宗谷地方\n  \"012000\": [\n    \"012010\", // 上川地方\n    \"012020\"  // 留萌地方\n  ],\n  \"013000\": [\"013000\"], // 網走・北見・紋別地方\n  \"014100\": [\n    \"014020\", // 釧路地方\n    \"014010\"  // 根室地方\n  ],\n  \"014030\": [\"014030\"], // 十勝地方\n  \"015000\": [\n    \"015010\", // 胆振地方\n    \"015020\"  // 日高地方\n  ],\n  \"016000\": [\n    \"016010\", // 石狩地方\n    \"016020\", // 空知地方\n    \"016030\"  // 後志地方\n  ],\n  \"017000\": [\n    \"017010\", // 渡島地方\n    \"017020\"  // 檜山地方\n  ]\n};\n","import React, { Component } from 'react';\n\nimport WeatherInfoSidebar from './WeatherInfoSidebar';\nimport WeatherInfoLayer from './WeatherInfoLayer';\n\nconst url = 'https://storage.googleapis.com/weather-info/weather-info-all.json';\n\nexport default class WeatherInfo extends Component {\n  state = {\n    info: null,\n  };\n\n  componentDidMount() {\n    this.loadWeatherInfo();\n  }\n\n  onload(map) {\n    this.map = map;\n    this.addLayer();\n  }\n  \n  loadWeatherInfo() {\n    const timestamp = new Date().getTime();\n    fetch(url + '?' + timestamp, {mode: 'cors'})\n      .then(res => res.json())\n      .then(data => {\n        console.log(data);\n        this.setState({ info: data });\n        this.weatherInfo = data;\n        this.addLayer();\n      });\n  }\n\n  addLayer() {\n    if (!this.map || !this.weatherInfo) return;\n    this.layer = new WeatherInfoLayer(this.map, this.weatherInfo, this.props.period, this.onSelected);\n  }\n\n  render() {\n    return (\n      <WeatherInfoSidebar\n        data={this.state.info}\n        period={this.props.period}\n        ref={el => this.sidebar = el}\n      />\n    );\n  }\n\n  onSelected = (code) => {\n    console.log(this.weatherInfo.prefs[code]);\n    if (this.weatherInfo.prefs[code]) {\n      this.sidebar.showPref(code);\n    }\n  }\n}\n","import React, { Component } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl/dist/mapbox-gl.css'\n\nimport WeatherInfo from './WeatherInfo';\n\nmapboxgl.accessToken = 'pk.eyJ1IjoidGF0dGlpIiwiYSI6ImNqZWZ4eWM3NTI2cGszM2xpYXEyZndpd3IifQ.ifzbR45HecVGxChbdR2hiw';\n\n\nexport default class Map extends Component {\n  componentDidMount() {\n    this.map = new mapboxgl.Map({\n      container: this.mapContainer,\n      //style: 'mapbox://styles/tattii/cjrdf8jy60arr2tpz9tcvdseo',\n      style: 'mapbox://styles/tattii/cj1bob6hw003t2rr5s2svi3iq',\n      zoom: 5,\n      center: [136.6, 35.5],\n      hash: true,\n      attributionControl: false\n    });\n\n    this.map.on('load', () => {\n      this.child.onload(this.map);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <div ref={el => this.mapContainer = el} id=\"map\" />\n        <WeatherInfo\n          ref={ref => this.child = ref}\n          period={2400}\n        />\n      </div>\n    )\n  }\n}\n","import React, { Component } from 'react';\n\nimport Map from './Map';\n\nclass App extends Component {\n  render() {\n    return (\n      <Map />\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('app'));\n\n"],"sourceRoot":""}